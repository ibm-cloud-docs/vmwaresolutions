---

copyright:

  years:  2016, 2018

lastupdated: "2018-10-10"

---

# バックアップ、災害復旧 (DR)、およびスケーラビリティー

## バックアップおよび DR

###	VCS のバックアップ

IBM Cloud for VMware Solutions の一部として、VMware クラスター外部の IBM Cloud Endurance Storage を使用する Veeam バックアップ・ソフトウェアが IBM Cloud 仮想サーバー・インスタンス (VSI) にオプションでデプロイされます。このソフトウェアの目的は、このソリューションの管理コンポーネントをバックアップすることです。

### NSX のバックアップ

障害が発生した場合にシステムをその動作状態にリストアするためには、すべての NSX コンポーネントを適切にバックアップしておくことが不可欠です。 NSX VM をバックアップするだけでは不十分です。適切にバックアップを行うために NSX Manager 内の NSX バックアップ機能を使用する必要があります。このためには、NSX バックアップ・データのリポジトリーとして FTP サーバーまたは SFTP サーバーを指定する必要があります。
NSX Manager のバックアップの対象となるのはすべての NSX 構成です。これには、コントローラー、論理スイッチング・エンティティー、論理ルーティング・エンティティー、セキュリティー、ファイアウォール・ルール、および NSX Manager UI または API 内で構成するその他すべての項目が含まれます。vCenter データベースおよびその関連エレメント (仮想スイッチなど) は、別個にバックアップする必要があります。NSX 構成は vCenter バックアップと共にバックアップする必要があります。

###	IBM Cloud Private のバックアップおよび DR

障害が発生した場合にシステムをその動作状態にリストアするためには、ICP のデプロイメントをバックアップしておくことが不可欠です。従来の VM バックアップには、問題点があります。つまり、すべての ICP マスター・ノードは etcd を実行しますが、etcd の文書には、リストアを行う際に従来の VM バックアップを使用してはならないと明確に記載されています。

プラットフォーム・レベルの IBM Cloud Private では、以下のコンポーネントをバックアップする必要があります。

-	**Etcd** — Kubernetes リソースおよび Calico 状態情報を保管するために使用されます。
-	**Docker レジストリー** — イメージ・リポジトリーにコンテナー・イメージ・ファイルを保管するために使用されるプライベート・イメージ・レジストリー。
-	**MongoDB** — 課金サービス、Helm リポジトリー・サーバー、Helm API サーバー、LDAP 構成、テナント (名前空間)、およびチーム/ユーザー/ユーザー・グループ役割の構成によって使用されるデータベース。
-	**MariaDB** — OIDC によって使用されるデータベース。
-	**Elasticsearch** — システム・ログおよびアプリケーション・ログを保管します。
-	**Prometheus** — モニタリング用のデータを保管します。
-	**永続ストレージ** - ICP または Kubernetes の永続ボリュームとストレージ・プロバイダーを利用する管理サービスで使用されます。ストレージ・プロバイダーが提供するバックアップ・テクノロジーまたはリストア・テクノロジーを使用できます。同様のプロセスをユーザーのアプリケーションに拡張することもできます。

###	CAM のバックアップおよび DR
障害が発生した場合にシステムをその動作状態にリストアするためには、CAM のデプロイメントをバックアップしておくことが不可欠です。CAM のバックアップでは、お客様は以下のコンポーネントをバックアップする必要があります。
-	**Mongo データベース** – メインの CAM データベース。
-	**Maria データベース** - CAM Blueprint Designer で使用されます。
-	**NFS/GlusterFS** - CAM データは 4 つの永続ボリュームに存在します。

### IKS のバックアップおよび DR
etcd データベースのバックアップは、管理対象サービスの一部としてお客様に提供されます。アプリケーション・データはすべて、自身でバックアップする必要があります。

## スケーラビリティー

### VCS のスケーラビリティー

初期ホストのデプロイメント後、ユーザーは IBM Cloud for VMware ポータル内からコンピュート・キャパシティーをスケールアウトできます。

環境のこのスケールアウトは、以下の 3 つの方法のいずれかを使用します。
- 別々の vCenter Server が管理する新規サイトを追加する。
- 新規クラスターを追加する。
- 既存クラスターに新規ホストを追加する。

####	マルチサイト・デプロイメント
VMware on IBM Cloud は、IBM Cloud の世界規模のデータ・センターおよび統合されたネットワーク・バックボーンを利用して、地域をまたがるさまざまなユース・ケースをデプロイし、インフラストラクチャーを最初から構築するよりもずっと短時間で機能できるようにします。

####	新規クラスターによるスケールアウト
ユーザーには、コンソール内から新規クラスターを作成し、ホストを注文することによって、コンピュート・キャパシティーをスケールアウトするというオプションもあります。新しいホストは、新規クラスターに自動的に追加されます。このオプションを採用すると、別個のクラスターが環境内に作成されます。ユーザーは、管理ワークロードをアプリケーション・ワークロードから物理的および論理的に分離できるようになりますし、その他の特性 (例えば、Microsoft SQL データベース・クラスターなど) に基づいてワークロードを分離したり、高可用性トポロジーにアプリケーションをデプロイしたりできるようになります。

####	既存のクラスターのスケールアウト
ユーザーは、コンソール内からホストを注文することによって既存のクラスターをスケールアウトできます。新しいホストは、当該クラスターに自動的に追加されます。場合によっては、ユーザーはその予約要件に基づいて、クラスターの HA 予約ポリシーを調整する必要があることに注意してください。

### ICP のスケーラビリティー
オンプレミスまたはクラウドのロケーションで使用可能なコンピュート・キャパシティーに基づいて、ユーザーは、最初にデプロイしたブート・ノードからノード・アーキテクチャーをスケールアウトすることができます。

環境のスケールアウトは以下の方法で行います。
- ICP ワーカー・ノードを拡張する。
- IKS オファリングを展開して使用する。

####	ICP の拡張
以下のように ICP ワーカー仮想マシン・ノードをスケーリングして、コンピュート/アプリケーションを拡張します。
  - お客様は ICP がデプロイされている VXLAN に新規仮想マシンをプロビジョンします。
  - お客様は、新規仮想マシンをプロビジョニングしてからブート・ノードにログインし、新規ノードをクラスターに追加するコマンドを実行することによって、ワーカー・ノードをスケーリングできます。
  - CAM を使用して、VM のプロビジョニング、および ICP クラスターへの追加を行うコマンドの実行を自動化します。


###  IKS の拡張
ユーザーは、IBM Cloud Portal を介して IKS 環境をプロビジョンし、コンテナー環境を拡張したり使用したりすることができます。

IKS へのアプリケーションのデプロイメントは、以下の方法で行うことができます。
- IKS 接続/サービスを CAM で開発して、ICP カタログに公開する。
- IKS インスタンスを管理するための Multi-Cloud Manager の今後の機能拡張
- Helm コマンド・ライン。
- 高可用性を向上させるためのマルチゾーン・クラスターの使用。

### 関連リンク
* [クラスター・ノードの追加または削除](https://www.ibm.com/support/knowledgecenter/en/SSBS6K_2.1.0.3/installing/modify_cluster.html)
* [既存のワーカー・プールのサイズを変更してワーカー・ノードを追加する](https://console.bluemix.net/docs/containers/cs_clusters.html#add_workers)
* [How to back up and restore IBM Cloud Private](https://medium.com/ibm-cloud/how-to-backup-and-restore-ibm-cloud-private-part-1-b6300dc1d7d8)
* [ICP backup](https://github.com/ibm-cloud-architecture/icp-backup/)
* [VMware vCenter Server on IBM Cloud with Hybridity Bundle](../vcs/vcs-hybridity-intro.html)
